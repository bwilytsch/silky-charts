{"version":3,"file":"Bar.js","sources":["../src/Bar.js"],"sourcesContent":["import React, { useRef, useState } from 'react';\nimport {\n  scaleBand as d3ScaleBand,\n  scaleLinear as d3ScaleLinear,\n} from 'd3-scale';\nimport { select as d3Select } from 'd3-selection';\nimport identity from 'ramda/src/identity';\nimport { GraphContext } from './contexts';\nimport {\n  Axis,\n  BarDatum,\n  DataGroup,\n  Grid,\n  Label,\n  MainGroup,\n  DataSource,\n  SVG,\n  Title,\n} from './components';\nimport useResize from './hooks/useResize';\nimport { drawGrid, getBaseColor, getMax, setupData } from './utils';\nimport {\n  ASPECT_RATIO,\n  MARGIN,\n  ROTATION,\n  SCALE_PADDING,\n  SIZE,\n  THEME,\n  X_TICKS,\n  Y_TICKS,\n  TIME_FORMAT,\n} from './utils/constants';\n\nconst Bar = ({\n  aspectRatio = ASPECT_RATIO,\n  data: chartData,\n  dataSource,\n  dateFormat = TIME_FORMAT,\n  grid,\n  height: graphHeight = undefined,\n  horizontal,\n  margin = MARGIN,\n  onClick = identity,\n  onMouseEnter = identity,\n  onMouseLeave = identity,\n  outlinedStyle,\n  padding: xScalePadding = SCALE_PADDING,\n  responsive,\n  staticTooltip,\n  theme = THEME,\n  title,\n  tooltip,\n  visibleTicks,\n  width: graphWidth = undefined,\n  xAxisChartLabel,\n  xAxisLabelRotation,\n  xAxisLabelRotationValue = ROTATION,\n  xAxisTicks = X_TICKS,\n  yAxisChartLabel,\n  yAxisTicks = Y_TICKS,\n}) => {\n  const svgRef = useRef();\n  const [{ width, height }, setSize] = useState(SIZE);\n  const [isDates, data] = setupData(chartData);\n\n  const xScale = d3ScaleBand()\n    .domain(data.map(({ name }) => name))\n    .range([0, width])\n    .padding(xScalePadding);\n\n  const yScale = d3ScaleLinear()\n    .domain([0, getMax(data.map(({ value }) => value))])\n    .range([height, 0]);\n\n  useResize({\n    aspectRatio,\n    graphHeight,\n    graphWidth,\n    margin,\n    responsive,\n    setSize,\n    svgRef,\n  });\n\n  return (\n    <GraphContext.Provider\n      value={{\n        dateFormat,\n        margin,\n        node: svgRef.current,\n        outlinedStyle,\n        staticTooltip,\n        visibleTicks,\n        xAxisLabelRotation,\n        xAxisLabelRotationValue,\n      }}\n    >\n      <SVG\n        size={{\n          width: graphWidth || width + margin.left + margin.right,\n          height: graphHeight || height + margin.top + margin.bottom,\n        }}\n        ref={svgRef}\n      >\n        <MainGroup margin={margin}>\n          {grid && (\n            <Grid\n              ref={node =>\n                d3Select(node).call(\n                  drawGrid(\n                    horizontal,\n                    xScale,\n                    height,\n                    yScale,\n                    width,\n                    xAxisTicks,\n                    yAxisTicks\n                  )\n                )\n              }\n            />\n          )}\n\n          {title && (\n            <Title margin={margin} width={width} height={height}>\n              {title}\n            </Title>\n          )}\n\n          {xAxisChartLabel && (\n            <Label axis=\"x\" margin={margin} width={width} height={height}>\n              {xAxisChartLabel}\n            </Label>\n          )}\n\n          {yAxisChartLabel && (\n            <Label axis=\"y\" margin={margin} width={width} height={height}>\n              {yAxisChartLabel}\n            </Label>\n          )}\n\n          {dataSource && (\n            <DataSource\n              dataSource={dataSource}\n              height={height}\n              margin={margin}\n              width={width}\n            />\n          )}\n\n          <DataGroup>\n            {data.map(({ name, value }, idx) => (\n              <BarDatum\n                key={idx}\n                datum={{\n                  name,\n                  value,\n                }}\n                color={getBaseColor(theme)}\n                x={xScale(name)}\n                y={yScale(value)}\n                width={xScale.bandwidth()}\n                height={height - yScale(value)}\n                onClick={onClick}\n                onMouseEnter={onMouseEnter}\n                onMouseLeave={onMouseLeave}\n                tooltip={tooltip}\n              />\n            ))}\n          </DataGroup>\n\n          <Axis\n            axis=\"x\"\n            axisTicks={xAxisTicks}\n            orientation=\"bottom\"\n            position={{ x: 0, y: height }}\n            scale={xScale}\n            toDate={isDates}\n          />\n\n          <Axis\n            axis=\"y\"\n            axisTicks={yAxisTicks}\n            orientation=\"left\"\n            scale={yScale}\n          />\n        </MainGroup>\n      </SVG>\n    </GraphContext.Provider>\n  );\n};\n\nexport default Bar;\n"],"names":["Bar","aspectRatio","ASPECT_RATIO","chartData","data","dataSource","dateFormat","TIME_FORMAT","grid","height","graphHeight","undefined","horizontal","margin","MARGIN","onClick","identity","onMouseEnter","onMouseLeave","outlinedStyle","padding","xScalePadding","SCALE_PADDING","responsive","staticTooltip","theme","THEME","title","tooltip","visibleTicks","width","graphWidth","xAxisChartLabel","xAxisLabelRotation","xAxisLabelRotationValue","ROTATION","xAxisTicks","X_TICKS","yAxisChartLabel","yAxisTicks","Y_TICKS","svgRef","useRef","useState","SIZE","setSize","setupData","isDates","xScale","d3ScaleBand","domain","map","name","range","yScale","d3ScaleLinear","getMax","value","useResize","React","GraphContext","node","current","SVG","left","right","top","bottom","MainGroup","Grid","d3Select","call","drawGrid","Title","Label","DataSource","DataGroup","idx","BarDatum","getBaseColor","bandwidth","Axis","x","y"],"mappings":"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"}